(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{623:function(e,t,n){Promise.resolve().then(n.bind(n,2864))},2864:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return AccountPage}});var r=n(7437),s=n(2265),i=n(3611),a=n(7323);function AccountPage(){let{user:e,loading:t,signIn:n,signUp:l,signOut:u}=(0,a.useAuth)(),[o,d]=(0,s.useState)(""),[c,h]=(0,s.useState)(""),[m,g]=(0,s.useState)(null),handleSignIn=async e=>{e.preventDefault(),g(null);let{error:t}=await n(o,c);t&&g(t)},handleSignUp=async()=>{g(null);let{error:e}=await l(o,c);e&&g(e)};return(0,r.jsx)("main",{className:"pt-24 pb-20",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-6",children:"My Account"}),e?(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow space-y-4",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold",children:["Welcome, ",e.email]}),(0,r.jsx)("div",{className:"text-gray-600",children:"Manage subscriptions, orders, and wishlist."}),(0,r.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 border rounded-xl",children:[(0,r.jsx)("div",{className:"font-semibold mb-1",children:"Subscriptions"}),(0,r.jsx)("div",{className:"text-sm text-gray-600 mb-3",children:"None active. Start one from a product page."}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)(i.z,{variant:"smileyOutline",onClick:async()=>{let t=await fetch("/api/portal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})}),n=await t.json();n.url&&(window.location.href=n.url)},children:"Manage Subscription"})})]}),(0,r.jsxs)("div",{className:"p-4 border rounded-xl",children:[(0,r.jsx)("div",{className:"font-semibold mb-1",children:"Orders"}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"No orders yet."})]})]}),(0,r.jsx)(i.z,{variant:"smiley",onClick:()=>u(),children:"Sign Out"})]}):(0,r.jsxs)("form",{onSubmit:handleSignIn,className:"bg-white rounded-2xl p-6 shadow space-y-4",children:[(0,r.jsx)("input",{type:"email",placeholder:"Email",value:o,onChange:e=>d(e.target.value),className:"w-full px-4 py-3 rounded-full border border-gray-200",required:!0}),(0,r.jsx)("input",{type:"password",placeholder:"Password",value:c,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 rounded-full border border-gray-200",required:!0}),m&&(0,r.jsx)("div",{className:"text-sm text-red-500",children:m}),(0,r.jsx)(i.z,{type:"submit",variant:"smiley",className:"w-full",disabled:t,children:"Sign In"}),(0,r.jsx)(i.z,{type:"button",onClick:handleSignUp,variant:"smileyOutline",className:"w-full",disabled:t,children:"Create Account"})]})]})})}},7323:function(e,t,n){"use strict";n.r(t),n.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var r=n(7437),s=n(2265),i=n(4841);let a=(0,s.createContext)(null);function AuthProvider(e){let{children:t}=e,[n,l]=(0,s.useState)(null),[u,o]=(0,s.useState)(!0);(0,s.useEffect)(()=>{if(!i.O){o(!1);return}let e=!0;(async()=>{let{data:t}=await i.O.auth.getSession();if(e){var n,r;l(null!==(r=null===(n=t.session)||void 0===n?void 0:n.user)&&void 0!==r?r:null),o(!1)}})();let{data:t}=i.O.auth.onAuthStateChange((e,t)=>{var n;l(null!==(n=null==t?void 0:t.user)&&void 0!==n?n:null)});return()=>{e=!1,t.subscription.unsubscribe()}},[]);let signIn=async(e,t)=>{if(!i.O)return{error:"Supabase not configured"};let{error:n}=await i.O.auth.signInWithPassword({email:e,password:t});return{error:null==n?void 0:n.message}},signUp=async(e,t)=>{if(!i.O)return{error:"Supabase not configured"};let{error:n}=await i.O.auth.signUp({email:e,password:t});return{error:null==n?void 0:n.message}},signOut=async()=>{i.O&&await i.O.auth.signOut()},d=(0,s.useMemo)(()=>({user:n,loading:u,signIn,signUp,signOut}),[n,u]);return(0,r.jsx)(a.Provider,{value:d,children:t})}function useAuth(){let e=(0,s.useContext)(a);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},3611:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(7437),s=n(2265),i=n(7256),a=n(6061),l=n(1628);let u=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 hover:scale-105",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",smiley:"bg-gradient-to-r from-smiely-mango to-smiely-strawberry text-white hover:shadow-lg hover:scale-105",smileyOutline:"bg-white text-smiely-mango border-2 border-smiely-mango hover:bg-smiely-mango hover:text-white",smileyAccent:"bg-smiely-yuzu text-white hover:bg-smiely-yuzu/90 hover:scale-105"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-full px-3",lg:"h-11 rounded-full px-8",xl:"h-14 rounded-full px-10 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,t)=>{let{className:n,variant:s,size:a,asChild:o=!1,...d}=e,c=o?i.g7:"button";return(0,r.jsx)(c,{className:(0,l.cn)(u({variant:s,size:a,className:n})),ref:t,...d})});o.displayName="Button"},4841:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var r=n(7440),s=n(2601);let i=s.env.NEXT_PUBLIC_SUPABASE_URL,a=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,l=i&&a?(0,r.eI)(i,a):null},1628:function(e,t,n){"use strict";n.d(t,{cn:function(){return cn}});var r=n(7042),s=n(4769);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[621,440,971,472,744],function(){return e(e.s=623)}),_N_E=e.O()}]);